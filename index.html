<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Monitor Energi V27 (Full Kalkulasi)</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/paho-mqtt/1.0.1/mqttws31.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gauge.js/1.3.7/gauge.min.js"></script>
    <style>
        body { font-family: 'Segoe UI', Roboto, sans-serif; background: #f0f2f5; padding: 20px; color: #333; }
        h1 { text-align: center; color: #0d47a1; margin-bottom: 5px; }
        h2 { text-align: center; color: #546e7a; font-size: 1.1em; margin-top: 0; margin-bottom: 25px; font-weight: 400; }
        #status { text-align: center; padding: 12px; margin-bottom: 20px; font-weight: 600; color: white; border-radius: 8px; box-shadow: 0 2px 4px rgba(0,0,0,0.1); }
        .bg-ok { background: #2e7d32; } .bg-err { background: #c62828; } .bg-wait { background: #f57c00; }
        
        .page { display: none; }
        .page.active { display: block; }
        
        /* Halaman 1: Menu */
        .menu-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(150px, 1fr)); gap: 15px; }
        .menu-card { background: #fff; padding: 20px; border-radius: 12px; box-shadow: 0 2px 5px rgba(0,0,0,0.05); text-align: center; font-size: 1.1em; font-weight: 600; color: #455a64; border-top: 5px solid #b0bec5; cursor: pointer; transition: all 0.2s ease; }
        .menu-card:hover { transform: translateY(-5px); box-shadow: 0 5px 15px rgba(0,0,0,0.1); }
        .menu-card.online { border-top-color: #43a047; }
        .menu-badge { display: block; font-size: 0.7em; font-weight: 700; color: #b0bec5; margin-top: 5px; }
        .menu-card.online .menu-badge { color: #43a047; }
        
        /* Halaman 2: Detail */
        .back-button { display: inline-block; background: #78909c; color: white; padding: 10px 15px; border-radius: 8px; text-decoration: none; font-weight: 600; margin-bottom: 20px; cursor: pointer; }
        .back-button:hover { background: #546e7a; }
        .tab-container { display: flex; margin-bottom: 20px; }
        .tab-button { padding: 12px 20px; font-size: 1em; font-weight: 600; border: none; background-color: #fff; color: #546e7a; cursor: pointer; border-bottom: 3px solid #cfd8dc; transition: all 0.2s; }
        .tab-button:hover { background-color: #f5f5f5; }
        .tab-button.active { color: #0d47a1; border-bottom: 3px solid #0d47a1; }
        .tab-content { display: none; }
        .tab-content.active { display: block; }
        .gauge-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 20px; margin-bottom: 20px; }
        .gauge-wrapper { background: #fff; padding: 15px; border-radius: 12px; box-shadow: 0 2px 5px rgba(0,0,0,0.05); text-align: center; }
        .gauge-wrapper canvas { width: 100%; height: auto; }
        .gauge-label { font-weight: 600; color: #0d47a1; margin-top: 10px; font-size: 1.1em; }
        .data-card { background: #fff; border-radius: 12px; box-shadow: 0 4px 15px rgba(0,0,0,0.05); overflow: hidden; }
        .data-table { width: 100%; font-size: 0.9em; border-collapse: separate; border-spacing: 0 5px; padding: 20px; }
        .data-table td { vertical-align: middle; padding: 2px 4px; }
        .lbl { color: #78909c; font-weight: 500; }
        .val { text-align: right; font-weight: 700; color: #263238; font-size: 1.15em; }
        .unit { color: #b0bec5; font-size: 0.85em; width: 45px; text-align: right; padding-left: 5px; }
        
        .row-energy { background: #e3f2fd; }
        .row-time { background: #e8f5e9; }
        .time-val { font-size: 1.05em; text-align: right; }
        
        /* Style baris baru (Kuning & Hijau) */
        .row-calc-cost { background: #fffbe6; }
        .row-calc-cost .val { color: #d46b08; font-weight: bold; }
        .row-calc-time { background: #f6ffed; }
        .row-calc-time .val { color: #389e0d; font-weight: bold; }
        
    </style>
</head>
<body>
    <h1>MONITORING ENERGI</h1>
    <h2>PT. Amarilys Karisma Gemilang</h2>
    <div id="status" class="bg-wait">Menghubungkan ke Sistem...</div>

    <div id="page-menu" class="page active">
        <div class="menu-grid" id="menu-grid-container">
            </div>
    </div>

    <div id="page-detail" class="page">
        <a class="back-button" onclick="showMenuView()">&#8592; Kembali ke Menu</a>
        <h2 id="detail-title">Detail Mesin</h2>
        
        <div class="tab-container">
            <button class="tab-button active" id="btn-full" onclick="showFullView()">Full Parameters</button>
            <button class="tab-button" id="btn-gauges" onclick="showGaugeView()">Core Parameters</button>
        </div>

        <div class="tab-content active" id="full-params-view">
            <div class="data-card">
                <table class="data-table" id="detail-data-table">
                    </table>
            </div>
        </div>
        
        <div class="tab-content" id="core-gauges-view">
            <div class="gauge-grid">
                <div class="gauge-wrapper"><canvas id="gauge-volt"></canvas><div class="gauge-label">Tegangan (V)</div></div>
                <div class="gauge-wrapper"><canvas id="gauge-amp"></canvas><div class="gauge-label">Arus (A)</div></div>
                <div class="gauge-wrapper"><canvas id="gauge-power"></canvas><div class="gauge-label">Daya Aktif (W)</div></div>
                <div class="gauge-wrapper"><canvas id="gauge-freq"></canvas><div class="gauge-label">Frekuensi (Hz)</div></div>
            </div>
        </div>
    </div>

<script>
    // === KONFIGURASI MQTT (SAMA) ===
    const MQTT_HOST = "701d32236feb43b38c22855a611f4d42.s1.eu.hivemq.cloud";
    const MQTT_PORT = 8884;
    const MQTT_USER = "web_dashboard";
    const MQTT_PASS = "Tristan12";
    const MQTT_TOPIC = "politeknik/meter/data";
    // ========================

    // ==========================================================
    // --- KONFIGURASI BARU UNTUK KALKULASI ---
    // ==========================================================
    // (GANTI ANGKA 1450 DENGAN TARIFMU)
    const TARIF_PER_KWH = 1450; // (Contoh: Rp 1.450 per kWh)
    
    // (Sesuaikan dengan SCAN_INTERVAL di ESP32-mu, dalam detik)
    const SCAN_INTERVAL_SEC = 30; // (Default 30 detik)
    
    // (Batas daya untuk dianggap "Standby", dalam Watt)
    const STANDBY_THRESHOLD_WATT = 10; 
    // ==========================================================

    const client = new Paho.MQTT.Client(MQTT_HOST, MQTT_PORT, "web_v27_spa_" + Date.now());

    // Variabel Global
    let gaugeV, gaugeA, gaugeP, gaugeHz;
    let machineId = 0;
    let gaugesInitialized = false; 
    let latestDataCache = {}; 
    
    // Variabel BARU untuk kalkulasi
    let energyTracker = {}; 
    const TRACKER_STORAGE_KEY = 'schneiderEnergyTracker_v2'; // v2

    // Helper
    const fmt = (val, dig) => (val != null && !isNaN(val)) ? Number(val).toFixed(dig) : "-";
    const fmt_rp = (val) => (val != null && !isNaN(val)) ? 'Rp ' + Number(val).toLocaleString('id-ID', {minimumFractionDigits: 0, maximumFractionDigits: 0}) : "-";

    // ======================================
    // --- 1. INISIALISASI & KONEKSI MQTT ---
    // ======================================
    
    function initDashboard() {
        let html = "";
        for (let i = 1; i <= 18; i++) {
            html += `
            <div class="menu-card" id="menu-card-${i}" onclick="showDetailView(${i})">
                Mesin ${i}
                <span class="menu-badge" id="menu-badge-${i}">OFFLINE</span>
            </div>`;
        }
        document.getElementById("menu-grid-container").innerHTML = html;
        
        loadEnergyTracker();
        showMenuView();
        startConnection();
    }

    function loadEnergyTracker() {
        const savedTracker = localStorage.getItem(TRACKER_STORAGE_KEY);
        if (savedTracker) {
            energyTracker = JSON.parse(savedTracker);
            console.log("Memuat tracker v2:", energyTracker);
        }
    }

    function startConnection() {
        setStatus("Menghubungkan...", "bg-wait");
        client.connect({
            useSSL: true, userName: MQTT_USER, password: MQTT_PASS,
            onSuccess: onConnect,
            onFailure: (e) => { setStatus("Gagal Terhubung: " + e.errorMessage, "bg-err"); setTimeout(startConnection, 5000); }
        });
    }
    
    function onConnect() {
        setStatus("ONLINE - MONITORING AKTIF", "bg-ok");
        client.subscribe(MQTT_TOPIC);
    }
    
    client.onConnectionLost = (r) => { if (r.errorCode !== 0) { setStatus("⚠️ Koneksi Terputus. Menyambung ulang...", "bg-wait"); setTimeout(startConnection, 5000); }};

    // ======================================
    // --- 2. LOGIKA UTAMA (SAAT PESAN MASUK) ---
    // ======================================

    client.onMessageArrived = (m) => {
        try {
            const d = JSON.parse(m.payloadString);
            if (!d.id) return;
            
            latestDataCache[d.id] = d;
            updateMenuCard(d);
            
            if (d.status === "online") {
                // Lakukan kalkulasi di background, walaupun tidak dilihat
                calculateUsageAndStatus(d);
            }
            
            if (d.id === machineId) {
                // Update tampilan HANYA jika sedang dilihat
                if (d.status === "offline") {
                    setMeterOffline();
                } else {
                    setMeterOnline(d);
                }
            }
        } catch (e) { console.error(e); }
    };

    function updateMenuCard(d) {
        const card = document.getElementById(`menu-card-${d.id}`);
        const badge = document.getElementById(`menu-badge-${d.id}`);
        if (!card || !badge) return;
        if (d.status === "offline") {
            card.classList.remove("online");
            badge.textContent = "OFFLINE";
        } else {
            card.classList.add("online");
            badge.textContent = "ONLINE";
        }
    }

    // ======================================
    // --- 3. NAVIGASI HALAMAN (SPA) ---
    // ======================================

    function showDetailView(id) {
        machineId = id; 
        document.getElementById("detail-title").textContent = `Detail Mesin ${machineId}`;
        
        // --- MODIFIKASI: Tambah 4 baris tabel baru ---
        document.getElementById("detail-data-table").innerHTML = `
            <tr class="row-energy"><td class="lbl">1. Total ea import</td><td class="val" id="d-e">-</td><td class="unit">kWh</td></tr>
            <tr class="row-energy"><td class="lbl">2. Total er import</td><td class="val" id="d-q_tot">-</td><td class="unit">kVARh</td></tr>
            <tr class="row-energy"><td class="lbl">3. partial active E</td><td class="val" id="d-e_part">-</td><td class="unit">kWh</td></tr>
            <tr class="row-energy"><td class="lbl">4. partial Reactive E</td><td class="val" id="d-q_part">-</td><td class="unit">kVARh</td></tr>
            <tr><td class="lbl">5. Voltage (V)</td><td class="val" id="d-v">-</td><td class="unit">V</td></tr>
            <tr><td class="lbl">6. Current (A)</td><td class="val" id="d-i">-</td><td class="unit">A</td></tr>
            <tr><td class="lbl">7. Active power (P)</td><td class="val" id="d-p">-</td><td class="unit">W</td></tr>
            <tr><td class="lbl">8. Reactive Power (Q)</td><td class="val" id="d-q">-</td><td class="unit">VAR</td></tr>
            <tr><td class="lbl">9. Apparent power (S)</td><td class="val" id="d-s">-</td><td class="unit">kVA</td></tr>
            <tr><td class="lbl">10. Power Factor (Pf)</td><td class="val" id="d-pf">-</td><td class="unit">PF</td></tr>
            <tr><td class="lbl">11. Frequency (F)</td><td class="val" id="d-hz">-</td><td class="unit">Hz</td></tr>
            <tr class="row-time"><td class="lbl">12. Total Waktu Nyala (Meteran)</td><td class="val time-val" id="d-op_time" colspan="2">-</td></tr>
            <tr class="row-calc-time"><td class="lbl">13. Waktu Standby (Mingguan)</td><td class="val" id="d-time-standby" colspan="2">-</td></tr>
            <tr class="row-calc-time"><td class="lbl">14. Waktu Digunakan (Mingguan)</td><td class="val" id="d-time-used" colspan="2">-</td></tr>
            <tr class="row-calc-cost"><td class="lbl">15. Biaya Harian (Est.)</td><td class="val" id="d-cost-daily" colspan="2">-</td></tr>
            <tr class="row-calc-cost"><td class="lbl">16. Biaya Mingguan (Est.)</td><td class="val" id="d-cost-weekly" colspan="2">-</td></tr>
        `;
        
        if (latestDataCache[id]) {
            setMeterOnline(latestDataCache[id]); // Tampilkan data terakhir (termasuk kalkulasi)
        } else {
            setMeterOffline(); 
        }

        showFullView();
        
        document.getElementById("page-menu").classList.remove("active");
        document.getElementById("page-detail").classList.add("active");
    }

    function showMenuView() {
        machineId = 0; 
        document.getElementById("page-detail").classList.remove("active");
        document.getElementById("page-menu").classList.add("active");
        gaugesInitialized = false; 
    }

    // --- FUNGSI NAVIGASI TAB (SAMA) ---
    function showFullView() {
        document.getElementById("full-params-view").style.display = "block";
        document.getElementById("core-gauges-view").style.display = "none";
        document.getElementById("btn-full").classList.add("active");
        document.getElementById("btn-gauges").classList.remove("active");
    }

    function showGaugeView() {
        document.getElementById("full-params-view").style.display = "none";
        document.getElementById("core-gauges-view").style.display = "block";
        document.getElementById("btn-full").classList.remove("active");
        document.getElementById("btn-gauges").classList.add("active");

        if (!gaugesInitialized) {
            setupGauges();
            gaugesInitialized = true;
            if (latestDataCache[machineId]) {
                setMeterOnline(latestDataCache[machineId]);
            } else {
                setMeterOffline();
            }
        }
    }
    
    // --- FUNGSI SETUP GAUGE (SAMA) ---
    function setupGauges() {
        const baseOpts = { angle: 0.0, lineWidth: 0.3, radiusScale: 0.9, pointer: { length: 0.5, strokeWidth: 0.03, color: '#000000' }, limitMax: false, limitMin: false, colorStart: '#6FADCF', colorStop: '#8FC0DA', strokeColor: '#E0E0E0', generateGradient: true };
        
        var optsV = { ...baseOpts }; 
        optsV.staticLabels = { font: "12px sans-serif", labels: [0, 50, 100, 150, 200, 220, 250, 300], color: "#555" };
        optsV.staticZones = [ {strokeStyle: "#30B32D", min: 200, max: 240}, {strokeStyle: "#FFDD00", min: 240, max: 260}, {strokeStyle: "#F03E3E", min: 260, max: 300} ];
        gaugeV = new Gauge(document.getElementById('gauge-volt')).setOptions(optsV);
        gaugeV.maxValue = 300; gaugeV.set(0);

        var optsA = { ...baseOpts }; 
        optsA.staticLabels = { font: "12px sans-serif", labels: [0, 20, 40, 60, 80, 100], color: "#555" };
        optsA.staticZones = [ {strokeStyle: "#30B32D", min: 0, max: 70}, {strokeStyle: "#FFDD00", min: 70, max: 90}, {strokeStyle: "#F03E3E", min: 90, max: 100} ];
        gaugeA = new Gauge(document.getElementById('gauge-amp')).setOptions(optsA);
        gaugeA.maxValue = 100; gaugeA.set(0);

        var optsP = { ...baseOpts }; 
        optsP.staticLabels = { font: "12px sans-serif", labels: [0, 5000, 10000, 15000, 20000, 25000], color: "#555" };
        optsP.staticZones = [ {strokeStyle: "#30B32D", min: 0, max: 15000}, {strokeStyle: "#FFDD00", min: 15000, max: 20000}, {strokeStyle: "#F03E3E", min: 20000, max: 25000} ];
        gaugeP = new Gauge(document.getElementById('gauge-power')).setOptions(optsP);
        gaugeP.maxValue = 25000; gaugeP.set(0);
        
        var optsHz = { ...baseOpts }; 
        optsHz.staticLabels = { font: "12px sans-serif", labels: [45, 48, 50, 52, 55], color: "#555" };
        optsHz.staticZones = [ {strokeStyle: "#F03E3E", min: 45, max: 48}, {strokeStyle: "#30B32D", min: 48, max: 52}, {strokeStyle: "#F03E3E", min: 52, max: 55} ];
        gaugeHz = new Gauge(document.getElementById('gauge-freq')).setOptions(optsHz);
        gaugeHz.maxValue = 55;
        gaugeHz.minValue = 45;
        gaugeHz.set(50);
    }
    
    // ================================================
    // --- 4. FUNGSI UTAMA BARU: KALKULASI & TAMPIL ---
    // ================================================
    
    // --- FUNGSI BARU UNTUK MENGHITUNG ---
    function calculateUsageAndStatus(d) {
        if (!d || d.e == null || isNaN(d.e) || d.p == null || isNaN(d.p)) return;

        const now = new Date();
        const today = now.getDate(); // 1-31
        const dayOfWeek = now.getDay(); // 0=Minggu, 1=Senin...
        const currentEnergy = d.e;
        const currentPower = d.p;

        let tracker = energyTracker[d.id];
        
        // Inisialisasi tracker jika ini mesin baru
        if (!tracker) {
            console.log(`[ID ${d.id}] Membuat tracker baru.`);
            tracker = {
                dailyStart_kWh: currentEnergy,
                weeklyStart_kWh: currentEnergy,
                dailyPacketsStandby: 0,
                dailyPacketsUsed: 0,
                weeklyPacketsStandby: 0,
                weeklyPacketsUsed: 0,
                lastUpdateDay: today,
                lastUpdateDayOfWeek: dayOfWeek
            };
            energyTracker[d.id] = tracker;
        }

        // --- Cek Rollover Harian ---
        if (today !== tracker.lastUpdateDay) {
            console.log(`[ID ${d.id}] Rollover HARI (dari ${tracker.lastUpdateDay} ke ${today}).`);
            tracker.dailyStart_kWh = currentEnergy; // Reset odometer harian
            tracker.dailyPacketsStandby = 0; // Reset waktu harian
            tracker.dailyPacketsUsed = 0;
            tracker.lastUpdateDay = today;
        }

        // --- Cek Rollover Mingguan ---
        // (Asumsi Minggu = 0, hari pertama)
        if (dayOfWeek < tracker.lastUpdateDayOfWeek) {
            console.log(`[ID ${d.id}] Rollover MINGGU (dari ${tracker.lastUpdateDayOfWeek} ke ${dayOfWeek}).`);
            tracker.weeklyStart_kWh = currentEnergy; // Reset odometer mingguan
            tracker.weeklyPacketsStandby = 0; // Reset waktu mingguan
            tracker.weeklyPacketsUsed = 0;
        }
        tracker.lastUpdateDayOfWeek = dayOfWeek; // Selalu update hari terakhir

        // --- Lakukan Kalkulasi Status (Hitung Paket) ---
        if (currentPower < STANDBY_THRESHOLD_WATT) {
            // STANDBY (Kuning)
            tracker.dailyPacketsStandby++;
            tracker.weeklyPacketsStandby++;
        } else {
            // DIGUNAKAN (Hijau)
            tracker.dailyPacketsUsed++;
            tracker.weeklyPacketsUsed++;
        }

        // Simpan kembali ke localStorage
        localStorage.setItem(TRACKER_STORAGE_KEY, JSON.stringify(energyTracker));
    }

    // --- FUNGSI TAMPIL ONLINE (MODIFIKASI) ---
    function setMeterOnline(d) {
        // --- 1. UPDATE 12 DATA TABEL (SAMA) ---
        document.getElementById(`d-e`).textContent  = fmt(d.e, 2);
        document.getElementById(`d-q_tot`).textContent = fmt(d.q_tot, 2);
        document.getElementById(`d-e_part`).textContent  = fmt(d.e_part, 2);
        document.getElementById(`d-q_part`).textContent  = fmt(d.q_part, 2);
        document.getElementById(`d-v`).textContent  = fmt(d.v, 1);
        document.getElementById(`d-i`).textContent  = fmt(d.i, 3);
        document.getElementById(`d-p`).textContent  = fmt(d.p, 0); 
        document.getElementById(`d-q`).textContent  = fmt(d.q, 0); 
        document.getElementById(`d-s`).textContent  = fmt(d.s, 2); 
        document.getElementById(`d-pf`).textContent = fmt(d.pf, 2);
        document.getElementById(`d-hz`).textContent = fmt(d.hz, 1);

        const total_hours = d.op_time;
        if (total_hours != null && !isNaN(total_hours)) {
            const days = Math.floor(total_hours / 24);
            const hours = (total_hours % 24).toFixed(1);
            document.getElementById(`d-op_time`).textContent = `${days} hari & ${hours} jam`;
        } else {
            document.getElementById(`d-op_time`).textContent = "-";
        }
        
        // --- 2. UPDATE 4 GAUGE (SAMA) ---
        if (gaugesInitialized) {
            gaugeV.set(d.v);
            gaugeA.set(d.i);
            gaugeP.set(d.p);
            gaugeHz.set(d.hz);
        }
        
        // --- 3. TAMPILKAN HASIL KALKULASI (BARU) ---
        const tracker = energyTracker[d.id];
        if (tracker && d.e != null && !isNaN(d.e)) {
            // Hitung Biaya
            const dailyUsage_kWh = d.e - tracker.dailyStart_kWh;
            const weeklyUsage_kWh = d.e - tracker.weeklyStart_kWh;
            const dailyCost = dailyUsage_kWh * TARIF_PER_KWH;
            const weeklyCost = weeklyUsage_kWh * TARIF_PER_KWH;
            
            // Hitung Waktu (dari paket data)
            const weeklyStandbyHours = (tracker.weeklyPacketsStandby * SCAN_INTERVAL_SEC) / 3600;
            const weeklyUsedHours = (tracker.weeklyPacketsUsed * SCAN_INTERVAL_SEC) / 3600;
            
            document.getElementById(`d-cost-daily`).textContent = `${fmt_rp(dailyCost)} (${fmt(dailyUsage_kWh, 2)} kWh)`;
            document.getElementById(`d-cost-weekly`).textContent = `${fmt_rp(weeklyCost)} (${fmt(weeklyUsage_kWh, 2)} kWh)`;
            document.getElementById(`d-time-standby`).textContent = `${fmt(weeklyStandbyHours, 1)} Jam`;
            document.getElementById(`d-time-used`).textContent = `${fmt(weeklyUsedHours, 1)} Jam`;
        } else {
            document.getElementById(`d-cost-daily`).textContent = "-";
            document.getElementById(`d-cost-weekly`).textContent = "-";
            document.getElementById(`d-time-standby`).textContent = "-";
            document.getElementById(`d-time-used`).textContent = "-";
        }
    }

    // --- FUNGSI TAMPIL OFFLINE (MODIFIKASI) ---
    function setMeterOffline() {
        // --- RESET 16 DATA TABEL ---
        document.getElementById(`d-e`).textContent  = "-";
        document.getElementById(`d-q_tot`).textContent = "-";
        document.getElementById(`d-e_part`).textContent  = "-";
        document.getElementById(`d-q_part`).textContent  = "-";
        document.getElementById(`d-v`).textContent  = "-";
        document.getElementById(`d-i`).textContent  = "-";
        document.getElementById(`d-p`).textContent  = "-";
        document.getElementById(`d-q`).textContent  = "-";
        document.getElementById(`d-s`).textContent  = "-";
        document.getElementById(`d-pf`).textContent = "-";
        document.getElementById(`d-hz`).textContent = "-";
        document.getElementById(`d-op_time`).textContent = "-";
        document.getElementById(`d-cost-daily`).textContent = "-";
        document.getElementById(`d-cost-weekly`).textContent = "-";
        document.getElementById(`d-time-standby`).textContent = "-";
        document.getElementById(`d-time-used`).textContent = "-";

        // --- RESET 4 GAUGE (SAMA) ---
        if (gaugesInitialized) {
            gaugeV.set(0);
            gaugeA.set(0);
            gaugeP.set(0);
            gaugeHz.set(50);
        }
    }

    function setStatus(msg, cls) { const s = document.getElementById("status"); s.textContent = msg; s.className = cls; }
    
    // Mulai!
    initDashboard();
</script>
</body>
</html>
