<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dashboard Detail (v41)</title>
    
    <style>
        /* --- CSS BARU (Lebih Sederhana) --- */
        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
            background-color: #f0f2f5;
            color: #333;
            margin: 0;
            padding: 25px;
        }
        
        .back-button {
            display: inline-block;
            position: absolute;
            top: 25px;
            right: 25px;
            background: #78909c;
            color: white;
            padding: 10px 15px;
            border-radius: 8px;
            text-decoration: none;
            font-weight: 600;
            z-index: 10;
        }
        .back-button:hover { background: #546e7a; }

        h1 {
            text-align: left;
            color: #1a237e;
            margin-bottom: 5px;
            font-size: 2.5em;
        }
        h2 {
            text-align: left;
            color: #546e7a;
            font-size: 1.1em;
            margin-top: 0;
            margin-bottom: 25px;
            font-weight: 400;
        }

        /* LAYOUT GRID UTAMA */
        .dashboard-grid {
            display: grid;
            /* Grid responsif, minimal 300px, 1fr = isi sisa space */
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            grid-auto-rows: auto;
            gap: 20px;
        }

        /* KARTU DATA */
        .card {
            background: #ffffff;
            border-radius: 12px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.07);
            padding: 20px 25px;
        }
        .card h3 {
            margin-top: 0;
            border-bottom: 2px solid #f0f2f5;
            padding-bottom: 10px;
            color: #004d40; /* Hijau tua */
        }
        
        /* Tampilan data point */
        .data-point {
            margin-bottom: 18px;
        }
        .data-point .label {
            display: block;
            font-size: 1em;
            color: #546e7a;
            margin-bottom: 4px;
        }
        .data-point .value {
            font-size: 2.4em;
            font-weight: 600;
            color: #0d47a1;
        }
        .data-point .unit {
            font-size: 1.1em;
            color: #444;
            margin-left: 8px;
        }
        /* Style khusus untuk P,Q,S */
        .power-group {
            display: grid;
            grid-template-columns: 1fr 1fr 1fr;
            gap: 10px;
        }
        .power-group .value { font-size: 1.8em; }
        
        /* Style khusus untuk V&I dan Pf&F */
        .dual-group {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
        }
    </style>
</head>
<body>
    
    <a href="monitoring-menu.html" class="back-button">&#8592; Kembali (Pilih Mesin)</a>

    <h1>Energy Dashboard - Mesin 1</h1> <h2>Menampilkan data simulasi untuk parameter Schneider</h2>

    <div class="dashboard-grid">

        <div class="card">
            <h3>Energi Total</h3>
            <div class="data-point">
                <span class="label">1. Total ea import</span>
                <div>
                    <span class="value" id="val-total-ea">0.00</span>
                    <span class="unit">kWh</span>
                </div>
            </div>
            <div class="data-point">
                <span class="label">2. Total er import</span>
                <div>
                    <span class="value" id="val-total-er">0.00</span>
                    <span class="unit">kVARh</span>
                </div>
            </div>
        </div>

        <div class="card">
            <h3>Energi Parsial</h3>
            <div class="data-point">
                <span class="label">3. partial active E</span>
                <div>
                    <span class="value" id="val-part-e">0.00</span>
                    <span class="unit">kWh</span>
                </div>
            </div>
            <div class="data-point">
                <span class="label">4. partial Reactive E</span>
                <div>
                    <span class="value" id="val-part-r">0.00</span>
                    <span class="unit">kVARh</span>
                </div>
            </div>
        </div>
        
        <div class="card">
            <h3>Listrik Dasar (6 & 8)</h3>
            <div class="dual-group">
                <div class="data-point">
                    <span class="label">V (Tegangan)</span>
                    <div>
                        <span class="value" id="val-v">0.0</span>
                        <span class="unit">V</span>
                    </div>
                </div>
                <div class="data-point">
                    <span class="label">I (Arus)</span>
                    <div>
                        <span class="value" id="val-i">0.00</span>
                        <span class="unit">A</span>
                    </div>
                </div>
                <div class="data-point">
                    <span class="label">Pf (Power Factor)</span>
                    <div>
                        <span class="value" id="val-pf">0.00</span>
                        <span class="unit"></span>
                    </div>
                </div>
                <div class="data-point">
                    <span class="label">F (Frekuensi)</span>
                    <div>
                        <span class="value" id="val-hz">0.0</span>
                        <span class="unit">Hz</span>
                    </div>
                </div>
            </div>
        </div>

        <div class="card">
            <h3>Daya (7)</h3>
            <div class="power-group">
                <div class="data-point">
                    <span class="label">P (Active)</span>
                    <div>
                        <span class="value" id="val-p">0</span>
                        <span class="unit">W</span>
                    </div>
                </div>
                <div class="data-point">
                    <span class="label">Q (Reactive)</span>
                    <div>
                        <span class="value" id="val-q">0</span>
                        <span class="unit">VAR</span>
                    </div>
                </div>
                <div class="data-point">
                    <span class="label">S (Apparent)</span>
                    <div>
                        <span class="value" id="val-s">0.00</span>
                        <span class="unit">kVA</span>
                    </div>
                </div>
            </div>
        </div>

        <div class="card">
            <h3>Waktu Operasi (9)</h3>
            <div class="dual-group">
                <div class="data-point">
                    <span class="label">Hari</span>
                    <div>
                        <span class="value" id="val-op-days">0</span>
                        <span class="unit">Days</span>
                    </div>
                </div>
                <div class="data-point">
                    <span class="label">Jam</span>
                    <div>
                        <span class="value" id="val-op-hrs">0.0</span>
                        <span class="unit">Hrs</span>
                    </div>
                </div>
            </div>
        </div>

        <div class="card">
            <h3>Tariff (5)</h3>
            <div class="data-point">
                <span class="label">Status</span>
                <div>
                    <span class="value" id="val-tariff">-</span>
                    <span class="unit"></span>
                </div>
            </div>
        </div>
        
    </div>


<script>
// ==========================================================
// --- JAVASCRIPT BARU (Data Dummy) ---
// ==========================================================
let activeMachineId = 1; // Default
const rand = (min, max, dec = 0) => (Math.random() * (max - min) + min).toFixed(dec);

/**
 * Update data (dummy) secara berkala
 */
function updateDashboard() {
    
    // 1. Total ea import : kwh
    document.getElementById('val-total-ea').textContent = rand(10000, 15000, 2);
    // 2. Total er import : kvARh
    document.getElementById('val-total-er').textContent = rand(5000, 8000, 2);
    // 3. partial active E : kwh
    document.getElementById('val-part-e').textContent = rand(10, 100, 2);
    // 4. partial Reactive E : kvARh
    document.getElementById('val-part-r').textContent = rand(5, 50, 2);
    // 5. Tariffs - (biarkan statis)
    document.getElementById('val-tariff').textContent = "T1";
    // 6. V & I : V dan A
    document.getElementById('val-v').textContent = rand(218, 225, 1);
    document.getElementById('val-i').textContent = rand(10, 15, 2);
    // 7. P,Q & S : W, VAR, kVA
    document.getElementById('val-p').textContent = rand(2000, 3000, 0);
    document.getElementById('val-q').textContent = rand(400, 800, 0);
    document.getElementById('val-s').textContent = rand(2.1, 3.1, 2);
    // 8. Pf & F Hz
    document.getElementById('val-pf').textContent = rand(0.85, 0.95, 2);
    document.getElementById('val-hz').textContent = rand(49.8, 50.2, 1);
    // 9. Operation time = days & hrs
    document.getElementById('val-op-days').textContent = 120; // Biar statis
    document.getElementById('val-op-hrs').textContent = rand(1, 23, 1);
}

// ==========================================================
// --- INISIALISASI ---
// ==========================================================
window.onload = function() {
    try {
        // Ambil ID dari URL
        const urlParams = new URLSearchParams(window.location.search);
        const id = urlParams.get('id');
        if (id && !isNaN(id)) {
            activeMachineId = parseInt(id);
        }
        
        // Update judul H1
        document.querySelector('h1').textContent = `Energy Dashboard - Mesin ${activeMachineId}`;

        // Panggil data pertama kali
        updateDashboard(); 
        
        // Set interval update
        setInterval(updateDashboard, 2000); // Update tiap 2 detik
        
    } catch (e) {
        console.error("Gagal inisialisasi:", e);
    }
}

</script>
</body>
</html>
