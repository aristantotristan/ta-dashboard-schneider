<!DOCTYPE html>
<html>
<head>
<title>TARIF & COST</title>
<style>
body{background:#020617;color:white;font-family:Arial}
.box{background:#020617;padding:20px;border-radius:10px}
</style>
</head>
<body>

<h2>ðŸ’° TARIF & BIAYA LISTRIK</h2>

<div class="box">
<p>Tarif LWBP: <span id="lwbp"></span></p>
<p>Tarif WBP: <span id="wbp"></span></p>
<p>Active Tarif: <b id="active"></b></p>
<p>Power (W): <span id="p"></span></p>
<p>Estimated Cost / hour: <b id="cost"></b></p>
</div>

<script>
const SUPA="https://YOUR_PROJECT_ID.supabase.co";
const KEY="YOUR_ANON_KEY";

async function calc(){
  const t=await fetch(`${SUPA}/rest/v1/config_tarif?select=*`,{headers:{apikey:KEY,Authorization:"Bearer "+KEY}});
  const tariff=(await t.json())[0];

  const d=await fetch(`${SUPA}/rest/v1/meter_data?select=p&order=timestamp.desc&limit=1`,
   {headers:{apikey:KEY,Authorization:"Bearer "+KEY}});
  const data=(await d.json())[0];

  const h=new Date().getHours();
  const isWBP=h>=tariff.wbp_start&&h<tariff.wbp_end;
  const rate=isWBP?tariff.rate_wbp:tariff.rate_lwbp;

  lwbp.innerText=tariff.rate_lwbp;
  wbp.innerText=tariff.rate_wbp;
  active.innerText=isWBP?"WBP":"LWBP";
  p.innerText=data.p;

  const cost=(data.p/1000)*rate;
  cost.innerText="Rp "+cost.toFixed(2);
}
calc();
setInterval(calc,3000);
</script>

</body>
</html>
